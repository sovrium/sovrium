{
  "$id": "view.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Table View",
  "description": "A view configuration defining how to display and filter table data",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9_]*$",
      "description": "Unique view identifier (lowercase with underscores)"
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "description": "Display name for the view"
    },
    "type": {
      "type": "string",
      "enum": ["grid", "kanban", "calendar", "gallery", "form"],
      "default": "grid",
      "description": "View type determining the display layout"
    },
    "filters": {
      "$ref": "./filters/filters.schema.json",
      "description": "Filter conditions to apply to records"
    },
    "sorts": {
      "$ref": "./sorts/sorts.schema.json",
      "description": "Sorting rules for records"
    },
    "fields": {
      "$ref": "./fields/fields.schema.json",
      "description": "Field visibility and display configuration"
    },
    "groupBy": {
      "$ref": "./group-by/group-by.schema.json",
      "description": "Grouping configuration"
    },
    "isDefault": {
      "type": "boolean",
      "default": false,
      "description": "Whether this is the default view for the table"
    }
  },
  "required": ["id", "name", "type"],
  "additionalProperties": false,
  "examples": [
    {
      "id": "all_active",
      "name": "All Active",
      "type": "grid",
      "filters": {
        "operator": "AND",
        "conditions": [
          {
            "field": "status",
            "operator": "equals",
            "value": "active"
          }
        ]
      },
      "sorts": [
        {
          "field": "created_at",
          "direction": "desc"
        }
      ],
      "isDefault": true
    },
    {
      "id": "by_priority",
      "name": "By Priority",
      "type": "kanban",
      "groupBy": {
        "field": "priority",
        "direction": "desc"
      }
    },
    {
      "id": "calendar_view",
      "name": "Calendar",
      "type": "calendar",
      "fields": [
        {
          "name": "title",
          "visible": true,
          "order": 1
        },
        {
          "name": "due_date",
          "visible": true,
          "order": 2
        }
      ]
    }
  ],
  "x-specs": [
    {
      "id": "APP-TABLES-VIEW-001",
      "given": "a view with id, name, and type properties",
      "when": "validating the view schema",
      "then": "the view should be valid"
    },
    {
      "id": "APP-TABLES-VIEW-002",
      "given": "a view with invalid id format (contains uppercase or spaces)",
      "when": "validating the view schema",
      "then": "validation should fail with pattern mismatch error"
    },
    {
      "id": "APP-TABLES-VIEW-003",
      "given": "a view marked as isDefault: true",
      "when": "no specific view is requested via API",
      "then": "this view's configuration should be applied automatically"
    }
  ]
}
