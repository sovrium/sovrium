{
  "$id": "static-i18n.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Static Site Generation - Multi-Language Support",
  "description": "Specifications for internationalization in static site generation using $t: translation references from centralized languages.translations dictionary. Generates language directories, replaces translations at build time, includes hreflang links, and creates language switchers.",
  "type": "object",
  "properties": {
    "languages": {
      "$ref": "../app/languages/languages.schema.json",
      "description": "Language configuration using centralized translations dictionary (same format as app.languages)"
    },
    "baseUrl": {
      "type": "string",
      "format": "uri",
      "description": "Base URL for hreflang links and canonical URLs",
      "examples": ["https://example.com", "https://mysite.org"]
    },
    "outputDir": {
      "type": "string",
      "description": "Output directory for generated static files",
      "default": "dist",
      "examples": ["dist", "build", "out"]
    }
  },
  "required": ["languages"],
  "additionalProperties": false,
  "x-specs": [
    {
      "id": "STATIC-I18N-001",
      "given": "a static site configured with multiple languages using centralized translations",
      "when": "static site is generated",
      "then": "language directories should be created with same page structure in each language, using language codes from supported array",
      "validation": {
        "setup": {
          "languages": {
            "default": "en",
            "supported": [
              { "code": "en", "label": "English", "locale": "en-US" },
              { "code": "fr", "label": "Français", "locale": "fr-FR" },
              { "code": "es", "label": "Español", "locale": "es-ES" }
            ],
            "translations": {
              "en": { "home.title": "Home", "about.title": "About", "contact.title": "Contact" },
              "fr": {
                "home.title": "Accueil",
                "about.title": "À propos",
                "contact.title": "Contact"
              },
              "es-ES": {
                "home.title": "Inicio",
                "about.title": "Acerca de",
                "contact.title": "Contacto"
              }
            }
          },
          "pages": [
            { "path": "/", "meta": { "title": "$t:home.title" } },
            { "path": "/about", "meta": { "title": "$t:about.title" } },
            { "path": "/contact", "meta": { "title": "$t:contact.title" } }
          ]
        },
        "assertions": [
          "Languages config: default + supported array (same as app.languages)",
          "Translation references: Use $t:key syntax (not {{key}})",
          "Centralized translations: Single dictionary for all languages",
          "Language codes: Full locale codes (en-US, fr-FR, es-ES)"
        ]
      },
      "application": {
        "expectedOutput": {
          "structure": {
            "dist/": "index.html (default language redirect or en-US content)",
            "dist/en/": "index.html, about/index.html, contact/index.html",
            "dist/fr/": "index.html, about/index.html, contact/index.html",
            "dist/es/": "index.html, about/index.html, contact/index.html"
          },
          "directories": ["dist/en/", "dist/fr/", "dist/es/"]
        },
        "useCases": [
          "Multi-language sites: Support English, French, Spanish using centralized translations",
          "Language isolation: /en/, /fr/, /es/ subdirectories (using full locale codes)",
          "Same structure: Each language has identical page hierarchy",
          "Default language: Root index.html redirects or shows default language (en-US)",
          "Translation replacement: $t:home.title → 'Home' (en-US), 'Accueil' (fr-FR), 'Inicio' (es-ES)",
          "RTL languages: Handle ar-SA, he-IL with appropriate directory names and dir attribute"
        ],
        "assertions": [
          "Create a directory for each language code in supported array",
          "Use full locale codes as directory names (en-US/, fr-FR/, es-ES/)",
          "Generate the same page structure in each language directory",
          "Create a root index.html for default language or redirect",
          "Replace $t: references with translations from centralized dictionary",
          "Handle RTL languages with appropriate directory names and dir=\"rtl\" attribute"
        ]
      }
    },
    {
      "id": "STATIC-I18N-002",
      "given": "a static site with centralized translations and $t: references",
      "when": "static site is generated",
      "then": "HTML files should have $t: references replaced with translations, lang attribute set to full locale code, and locale-specific formatting applied",
      "validation": {
        "setup": {
          "languages": {
            "default": "en",
            "supported": [
              { "code": "en", "label": "English", "locale": "en-US" },
              { "code": "fr", "label": "Français", "locale": "fr-FR" }
            ],
            "translations": {
              "en": {
                "home.title": "Welcome",
                "home.description": "Welcome to our site",
                "home.cta": "Get Started"
              },
              "fr": {
                "home.title": "Bienvenue",
                "home.description": "Bienvenue sur notre site",
                "home.cta": "Commencer"
              }
            }
          },
          "pages": [
            {
              "path": "/",
              "meta": {
                "title": "$t:home.title",
                "description": "$t:home.description"
              },
              "sections": [
                { "type": "h1", "children": ["$t:home.title"] },
                { "type": "p", "children": ["$t:home.description"] },
                { "type": "button", "children": ["$t:home.cta"] }
              ]
            }
          ]
        },
        "assertions": [
          "$t: syntax matches app.languages pattern (not {{key}})",
          "Translation replacement at build time (SSG)",
          "Lang attribute: Full locale code (en-US, fr-FR)",
          "No $t: symbols in generated HTML"
        ]
      },
      "application": {
        "expectedOutput": {
          "en-US": {
            "file": "dist/en/index.html",
            "lang": "en-US",
            "title": "Welcome",
            "description": "Welcome to our site"
          },
          "fr-FR": {
            "file": "dist/fr/index.html",
            "lang": "fr-FR",
            "title": "Bienvenue",
            "description": "Bienvenue sur notre site"
          }
        },
        "expectedHTML": {
          "en-US": "<!DOCTYPE html>\n<html lang=\"en-US\">\n<head>\n  <title>Welcome</title>\n  <meta name=\"description\" content=\"Welcome to our site\">\n</head>\n<body>\n  <h1>Welcome</h1>\n  <p>Welcome to our site</p>\n  <button>Get Started</button>\n</body>\n</html>",
          "fr-FR": "<!DOCTYPE html>\n<html lang=\"fr-FR\">\n<head>\n  <title>Bienvenue</title>\n  <meta name=\"description\" content=\"Bienvenue sur notre site\">\n</head>\n<body>\n  <h1>Bienvenue</h1>\n  <p>Bienvenue sur notre site</p>\n  <button>Commencer</button>\n</body>\n</html>"
        },
        "useCases": [
          "Translation replacement: $t:home.title → 'Welcome' (en-US), 'Bienvenue' (fr-FR)",
          "Lang attribute: <html lang=\"en-US\"> vs <html lang=\"fr-FR\"> (full locale codes)",
          "Meta tags: Title and description localized for SEO",
          "Build-time translation: All $t: references resolved during static generation",
          "Default language: /en/ available, also at root level /",
          "No client-side i18n: Translations baked into HTML (SEO-friendly)"
        ],
        "assertions": [
          "Replace $t: references with translations from centralized dictionary",
          "Set correct lang attribute to full locale code (en-US, fr-FR, not en, fr)",
          "Generate proper meta descriptions in each language",
          "Default language should be available at root level",
          "No $t: symbols remain in generated HTML (all resolved at build time)",
          "Consistent with app.languages translation pattern"
        ]
      }
    },
    {
      "id": "STATIC-I18N-003",
      "given": "a static site with baseUrl and multiple languages using centralized translations",
      "when": "static site is generated",
      "then": "hreflang links should be added to HTML head with full URLs, using language codes from supported array, and x-default for default language",
      "validation": {
        "setup": {
          "baseUrl": "https://example.com",
          "languages": {
            "default": "en",
            "supported": [
              { "code": "en", "label": "English", "locale": "en-US" },
              { "code": "fr", "label": "Français", "locale": "fr-FR" },
              { "code": "es", "label": "Español", "locale": "es-ES" }
            ],
            "translations": {
              "en": { "home.title": "Home", "about.title": "About" },
              "fr": { "home.title": "Accueil", "about.title": "À propos" },
              "es-ES": { "home.title": "Inicio", "about.title": "Acerca de" }
            }
          },
          "pages": [
            { "path": "/", "meta": { "title": "$t:home.title" } },
            { "path": "/about", "meta": { "title": "$t:about.title" } }
          ]
        },
        "assertions": [
          "BaseUrl required for hreflang links",
          "Hreflang uses language codes from supported array",
          "Full locale codes in hreflang (en-US, fr-FR, es-ES)",
          "x-default points to default language"
        ]
      },
      "application": {
        "expectedOutput": {
          "rootPage": {
            "en-US": "dist/en/index.html",
            "fr-FR": "dist/fr/index.html",
            "es-ES": "dist/es/index.html"
          },
          "aboutPage": {
            "en-US": "dist/en/about/index.html",
            "fr-FR": "dist/fr/about/index.html",
            "es-ES": "dist/es/about/index.html"
          }
        },
        "expectedHTML": {
          "rootPage": "<head>\n  <link rel=\"canonical\" href=\"https://example.com/en/\">\n  <link rel=\"alternate\" hreflang=\"en\" href=\"https://example.com/en/\">\n  <link rel=\"alternate\" hreflang=\"fr\" href=\"https://example.com/fr/\">\n  <link rel=\"alternate\" hreflang=\"es\" href=\"https://example.com/es/\">\n  <link rel=\"alternate\" hreflang=\"x-default\" href=\"https://example.com/en/\">\n</head>",
          "aboutPage": "<head>\n  <link rel=\"canonical\" href=\"https://example.com/en/about\">\n  <link rel=\"alternate\" hreflang=\"en\" href=\"https://example.com/en/about\">\n  <link rel=\"alternate\" hreflang=\"fr\" href=\"https://example.com/fr/about\">\n  <link rel=\"alternate\" hreflang=\"es\" href=\"https://example.com/es/about\">\n  <link rel=\"alternate\" hreflang=\"x-default\" href=\"https://example.com/en/about\">\n</head>"
        },
        "useCases": [
          "SEO: Help search engines understand language variants",
          "Canonical URLs: Point to authoritative version of each page",
          "Hreflang: Link all language versions of same page using full locale codes",
          "x-default: Indicate default language for unknown locales (en-US)",
          "Nested paths: Hreflang works for /about, /blog/post-1, etc.",
          "International SEO: Google uses hreflang to show correct language version in search results"
        ],
        "assertions": [
          "Add hreflang link for each language code in supported array",
          "Use full locale codes (en-US, fr-FR, es-ES, not en, fr, es)",
          "Include x-default hreflang pointing to default language",
          "Use full URLs with baseUrl when provided",
          "Add canonical URL for each page",
          "Correctly handle nested paths in hreflang URLs",
          "Hreflang values match language.code from supported array"
        ]
      }
    },
    {
      "id": "STATIC-I18N-004",
      "given": "a static site with language switcher using centralized translations",
      "when": "static site is generated",
      "then": "language switcher should be generated with all languages from supported array, using translated labels from centralized dictionary, maintaining current page path",
      "validation": {
        "setup": {
          "languages": {
            "default": "en",
            "supported": [
              { "code": "en", "label": "English", "locale": "en-US" },
              { "code": "fr", "label": "Français", "locale": "fr-FR" },
              { "code": "es", "label": "Español", "locale": "es-ES" }
            ],
            "translations": {
              "en": { "lang.en-US": "English", "lang.fr-FR": "French", "lang.es-ES": "Spanish" },
              "fr": {
                "lang.en-US": "Anglais",
                "lang.fr-FR": "Français",
                "lang.es-ES": "Espagnol"
              },
              "es-ES": { "lang.en-US": "Inglés", "lang.fr-FR": "Francés", "lang.es-ES": "Español" }
            }
          },
          "pages": [
            { "path": "/", "meta": { "title": "Home" } },
            { "path": "/about", "meta": { "title": "About" } }
          ]
        },
        "assertions": [
          "Language switcher uses supported array for language list",
          "Labels translated using centralized translations dictionary",
          "Full locale codes in URLs and hreflang (en-US, fr-FR, es-ES)",
          "Current language marked with aria-current"
        ]
      },
      "application": {
        "expectedOutput": {
          "rootPage": {
            "en-US": "Language switcher with links to /en/, /fr/, /es/",
            "fr-FR": "Language switcher with links to /en/, /fr/, /es/",
            "es-ES": "Language switcher with links to /en/, /fr/, /es/"
          },
          "aboutPage": {
            "en-US": "Language switcher with links to /en/about, /fr/about, /es/about",
            "fr-FR": "Language switcher with links to /en/about, /fr/about, /es/about",
            "es-ES": "Language switcher with links to /en/about, /fr/about, /es/about"
          }
        },
        "expectedHTML": {
          "en-US": "<nav aria-label=\"Language switcher\">\n  <a href=\"/en/about\" hreflang=\"en\" aria-current=\"page\">English</a>\n  <a href=\"/fr/about\" hreflang=\"fr\">French</a>\n  <a href=\"/es/about\" hreflang=\"es\">Spanish</a>\n</nav>",
          "fr-FR": "<nav aria-label=\"Language switcher\">\n  <a href=\"/en/about\" hreflang=\"en\">Anglais</a>\n  <a href=\"/fr/about\" hreflang=\"fr\" aria-current=\"page\">Français</a>\n  <a href=\"/es/about\" hreflang=\"es\">Espagnol</a>\n</nav>"
        },
        "useCases": [
          "User preference: Allow users to switch language",
          "Path preservation: Switching from /en/about → /fr/about (same page)",
          "Localized labels: 'English' in EN, 'Français' in FR, 'Español' in ES (from centralized translations)",
          "Current language: Mark active language with aria-current",
          "Accessibility: aria-label for screen readers",
          "Consistent pattern: Language switcher uses same centralized translations as rest of app"
        ],
        "assertions": [
          "Generate language switcher with all languages from supported array",
          "Use full locale codes in URLs (/en/, /fr/, /es/)",
          "Maintain current page path when switching languages",
          "Translate language switcher labels from centralized translations dictionary",
          "Mark current language as active/selected with aria-current",
          "Include proper href attributes with full locale codes for each language option",
          "hreflang attribute matches language.code from supported array"
        ]
      }
    }
  ]
}
