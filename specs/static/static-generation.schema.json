{
  "$id": "static-generation.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Static Site Generation",
  "description": "Specifications for static site generation functionality in Sovrium (HTML generation, CSS compilation, directory structure, nested paths)",
  "x-specs": [
    {
      "id": "STATIC-GENERATION-001",
      "given": "an app configuration with multiple pages",
      "when": "static site is generated",
      "then": "HTML files should be created for all pages with proper file names and structure",
      "application": {
        "configuration": {
          "pages": [
            { "name": "Home", "path": "/" },
            { "name": "About", "path": "/about" },
            { "name": "Contact", "path": "/contact" }
          ]
        },
        "expectedOutput": {
          "files": [
            "dist/index.html (home page)",
            "dist/about.html or dist/about/index.html",
            "dist/contact.html or dist/contact/index.html",
            "dist/assets/output.css"
          ],
          "structure": "All files readable and valid"
        },
        "useCases": [
          "Multi-page site: Generate HTML for each configured page",
          "Home page: Create index.html for root path /",
          "Named pages: Create properly named files for /about, /contact",
          "Assets: Generate CSS file in assets directory",
          "File validation: All files readable and contain valid HTML"
        ],
        "assertions": [
          "Generate an HTML file for each page in the app configuration",
          "Create index.html for the home page (path: '/')",
          "Create properly named HTML files for other pages",
          "Generate CSS file in assets directory",
          "All files should be readable and valid"
        ]
      }
    },
    {
      "id": "STATIC-GENERATION-002",
      "given": "an app configuration with page metadata (lang, meta tags)",
      "when": "static site is generated",
      "then": "HTML files should include proper DOCTYPE, html tag with lang, and all meta tags",
      "application": {
        "configuration": {
          "lang": "en",
          "pages": [
            {
              "name": "Home",
              "path": "/",
              "meta": {
                "title": "Welcome Home",
                "description": "Home page description",
                "keywords": "home, landing, welcome"
              }
            }
          ]
        },
        "expectedOutput": {
          "file": "dist/index.html"
        },
        "expectedHTML": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Welcome Home</title>\n  <meta name=\"description\" content=\"Home page description\">\n  <meta name=\"keywords\" content=\"home, landing, welcome\">\n</head>\n<body>\n  <!-- page sections -->\n</body>\n</html>",
        "useCases": [
          "SEO: Include meta tags for search engines",
          "Accessibility: Set lang attribute for screen readers",
          "Responsive: Add viewport meta for mobile devices",
          "Standards: Start with <!DOCTYPE html> for HTML5"
        ],
        "assertions": [
          "HTML must start with <!DOCTYPE html>",
          "Include proper <html> tag with lang attribute",
          "Include all meta tags from page configuration",
          "Render page sections correctly in HTML",
          "Close all HTML tags properly"
        ]
      }
    },
    {
      "id": "STATIC-GENERATION-003",
      "given": "an app configuration with theme design tokens (colors, fonts)",
      "when": "static site is generated",
      "then": "CSS should be compiled with theme tokens as CSS custom properties and utility classes",
      "application": {
        "configuration": {
          "theme": {
            "colors": {
              "primary": "#007bff",
              "secondary": "#6c757d",
              "text": "#212529"
            },
            "fonts": {
              "body": {
                "family": "Inter",
                "fallback": "sans-serif"
              }
            },
            "spacing": {
              "section": "4rem"
            }
          }
        },
        "expectedOutput": {
          "file": "dist/assets/output.css",
          "minified": true
        },
        "expectedCSS": ":root {\n  --color-primary: #007bff;\n  --color-secondary: #6c757d;\n  --color-text: #212529;\n  --font-body: 'Inter', sans-serif;\n  --spacing-section: 4rem;\n}\n\n.bg-primary { background-color: var(--color-primary); }\n.text-primary { color: var(--color-primary); }\n.font-body { font-family: var(--font-body); }\n.py-section { padding-top: var(--spacing-section); padding-bottom: var(--spacing-section); }",
        "useCases": [
          "Theming: CSS custom properties for dynamic theme switching",
          "Tailwind integration: Utility classes for theme tokens",
          "Production: Minified CSS for faster loading",
          "Design tokens: Colors, fonts, spacing compiled to CSS"
        ],
        "assertions": [
          "Compile Tailwind CSS with theme configuration",
          "Include CSS custom properties for theme tokens",
          "Generate utility classes for theme values",
          "Output CSS to assets/output.css",
          "CSS should be valid and minified for production"
        ]
      }
    },
    {
      "id": "STATIC-GENERATION-004",
      "given": "an app configuration with pages at different path depths",
      "when": "static site is generated",
      "then": "directory structure should be created with HTML files in correct locations",
      "application": {
        "configuration": {
          "pages": [
            { "path": "/" },
            { "path": "/about" },
            { "path": "/blog" },
            { "path": "/blog/post-1" },
            { "path": "/docs/api/reference" }
          ]
        },
        "expectedOutput": {
          "structure": {
            "dist/": "index.html",
            "dist/about/": "index.html",
            "dist/blog/": "index.html",
            "dist/blog/post-1/": "index.html",
            "dist/docs/api/reference/": "index.html",
            "dist/assets/": "output.css, client.js"
          },
          "consistency": "Same structure for flat and nested paths"
        },
        "useCases": [
          "Flat paths: / and /about at root level",
          "Nested paths: /blog/post-1 creates blog/ subdirectory",
          "Deep nesting: /docs/api/reference creates nested structure",
          "Assets directory: Separate assets/ for CSS and JS"
        ],
        "assertions": [
          "Create directories for nested page paths",
          "Place HTML files in correct directories",
          "Create assets directory for CSS and JS",
          "Maintain consistent structure across all pages",
          "Handle both flat and nested page hierarchies"
        ]
      }
    },
    {
      "id": "STATIC-GENERATION-005",
      "given": "an app configuration with deeply nested page paths",
      "when": "static site is generated",
      "then": "all parent directories should be created and paths should be handled correctly",
      "application": {
        "configuration": {
          "pages": [
            { "path": "/docs/guides/getting-started" },
            { "path": "/docs/guides/advanced/authentication" },
            { "path": "/api/v1/users/endpoints" }
          ]
        },
        "expectedOutput": {
          "structure": {
            "dist/docs/guides/getting-started/": "index.html",
            "dist/docs/guides/advanced/authentication/": "index.html",
            "dist/api/v1/users/endpoints/": "index.html"
          },
          "directories": [
            "dist/docs/",
            "dist/docs/guides/",
            "dist/docs/guides/getting-started/",
            "dist/docs/guides/advanced/",
            "dist/docs/guides/advanced/authentication/",
            "dist/api/",
            "dist/api/v1/",
            "dist/api/v1/users/",
            "dist/api/v1/users/endpoints/"
          ]
        },
        "useCases": [
          "Documentation sites: Deep nesting for /docs/guides/getting-started",
          "API reference: Nested paths like /api/v1/users/endpoints",
          "Special characters: Hyphens and underscores in paths",
          "Parent directories: Automatic creation of all intermediates"
        ],
        "assertions": [
          "Support deeply nested paths (e.g., /docs/guides/getting-started)",
          "Create all necessary parent directories",
          "Generate HTML files with correct names",
          "Maintain path structure in output directory",
          "Handle special characters in paths safely"
        ]
      }
    },
    {
      "id": "STATIC-GENERATION-006",
      "given": "an app configuration with any page content",
      "when": "static HTML is generated",
      "then": "HTML should be properly formatted with Prettier using consistent indentation and line breaks",
      "application": {
        "configuration": {
          "pages": [
            {
              "name": "formatted",
              "path": "/formatted",
              "meta": {
                "lang": "en",
                "title": "Formatted Page",
                "description": "Page with properly formatted HTML",
                "viewport": "width=device-width, initial-scale=1.0"
              },
              "sections": [
                {
                  "type": "div",
                  "props": { "className": "container" },
                  "children": [
                    { "type": "h1", "children": ["Main Title"] },
                    {
                      "type": "div",
                      "children": [
                        { "type": "p", "children": ["First paragraph"] },
                        { "type": "p", "children": ["Second paragraph"] }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "expectedOutput": {
          "file": "dist/formatted.html",
          "formatter": "Prettier with HTML parser",
          "formatting": {
            "indentation": "2 spaces (from .prettierrc.json)",
            "lineBreaks": "Proper line breaks between major elements",
            "doctype": "<!DOCTYPE html> on first line",
            "selfClosingTags": "Proper formatting for self-closing tags",
            "attributes": "One attribute per line (singleAttributePerLine: true)"
          }
        },
        "expectedStructure": "<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Formatted Page</title>\n    <meta name=\"description\" content=\"Page with properly formatted HTML\">\n  </head>\n  <body>\n    <!-- Well-indented content -->\n  </body>\n</html>",
        "useCases": [
          "Professional formatting: Use Prettier for consistent HTML formatting across all files",
          "Developer experience: Readable HTML for debugging and inspection",
          "SEO: Well-structured HTML for search engine crawlers",
          "Maintenance: Easy to inspect generated output with proper indentation",
          "Standards: Following HTML formatting best practices via Prettier config"
        ],
        "assertions": [
          "Use Prettier to format all generated HTML files",
          "Apply .prettierrc.json configuration (2 spaces, singleAttributePerLine)",
          "HTML should have consistent indentation matching project standards",
          "Each major HTML element should be on its own line",
          "DOCTYPE declaration should be on the first line",
          "Nested elements should be properly indented",
          "Self-closing tags should be properly formatted",
          "Attributes should follow singleAttributePerLine rule"
        ]
      }
    }
  ]
}
